<div id="step-bar">
  <div class="all-steps">
    <div class="step">
      <p>‚òù</p>
      <h3>1 - S√©jour</h3>
    </div>
    <div class="step">
      <p>‚úå</p>
      <h3>2 - Voyageurs</h3>
    </div>
    <div class="step active-step">
      <p>üëè</p>
      <h3>3 - Validation</h3>
    </div>
  </div>
  <div class="price">
    <h4>90‚Ç¨</h4>
  </div>
</div>
<div id="summary-banner">
  <div class="summary-block">
    <div class="summary-content">
      <h2>V√©rifications et Paiement</h2>
      <h3 style="margin-bottom: 10px;"><%= @journey.people_count[/[123456789]/] %> voyageurs au d√©part de <%= @journey.origin %> le <%= @journey.detail.date %></h3>
      <h3 style="margin-top: 0;"><%= @journey.detail.is_a_surprise ? "Ce s√©jour est une surprise !" : "" %></h3>
      <h4>Num√©ro de commande</h4>
      <p>N<%= @journey.id %>LCT</p>
      <h4>Nom de r√©servation</h4>
      <p><%= @journey.client.gender %> <%= @journey.client.surname %> <%= @journey.client.name %></p>
      <p><%= @journey.client.address %></p>
      <p><%= @journey.client.mail %></p>
      <p><%= @journey.client.phone %></p>
      <h4>D√©tails</h4>
      <p><%= @journey.detail.housing_type %></p>
      <p><%= @journey.detail.activity_type ? "Activit√© : " + @journey.detail.activity_type : "Pas d'activit√© s√©lectionn√©e" %></p>
      <% if @journey.detail.points_of_attention %>
        <p>Points d'attentions (promis, on sera vigilants !) :</p>
        <p><%= @journey.detail.points_of_attention %></p>
      <% end %>
      <div class="summary-price">
        <h4>TOTAL</h4>
        <h4>90‚Ç¨</h4>
      </div>

    <h4 style="color: #E30054;">Vos informations bancaires</h4>
      <%= form_tag journey_charges_path(@journey) do %>
        <div class="stripe-form">
          <div class="form-row">
            <div id="card-element">
              <!-- a Stripe Element will be inserted here. -->
            </div>

            <!-- Used to display form errors -->
            <div id="card-errors" role="alert"></div>
          </div>

          <button>Payer</button>
        </div>

        <script>
          // Create a Stripe client
          var stripe = Stripe('pk_test_FIcncftTUIekAyAhLnpGL8jR');

          // Create an instance of Elements
          var elements = stripe.elements();

          // Custom styling can be passed to options when creating an Element.
          // (Note that this demo uses a wider set of styles than the guide below.)
          var style = {
            base: {
              color: '#32325d',
              lineHeight: '24px',
              fontFamily: '"Helvetica Neue", Helvetica, sans-serif',
              fontSmoothing: 'antialiased',
              fontSize: '16px',
              '::placeholder': {
                color: '#aab7c4'
              }
            },
            invalid: {
              color: '#fa755a',
              iconColor: '#fa755a'
            }
          };

          // Create an instance of the card Element
          var card = elements.create('card', {style: style});

          // Add an instance of the card Element into the `card-element` <div>
          card.mount('#card-element');

          // Handle real-time validation errors from the card Element.
          card.addEventListener('change', function(event) {
            var displayError = document.getElementById('card-errors');
            if (event.error) {
              displayError.textContent = event.error.message;
            } else {
              displayError.textContent = '';
            }
          });

          // Handle form submission
          var form = document.getElementById('payment-form');
          form.addEventListener('submit', function(event) {
            event.preventDefault();

            stripe.createToken(card).then(function(result) {
              if (result.error) {
                // Inform the user if there was an error
                var errorElement = document.getElementById('card-errors');
                errorElement.textContent = result.error.message;
              } else {
                // Send the token to your server
                stripeTokenHandler(result.token);
              }
            });
          });
        </script>
      <% end %>
    </div>
  </div>

  <% # link_to "Proc√©der au paiement", root_path(anchor: "home-banner"), class: "btn btn-primary btn-pay" %>
</div>

